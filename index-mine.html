<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/svg+xml" href="/vite.svg" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="style.css">
        <title>Vite App</title>
      </head>
    <body>
        <div id="main">
            <header id="main_index">
                <h1 id="main_index_title"></h1>
                <h3 id="main_index_description"></h3>
                <nav id="main_index_navigation"></nav>
            </header>
            <div>
                <header>
                    <h1 id="sub_index_title"></h1>
                    <h3 id="sub_index_description"></h3>
                    <h3 id="sub_index_category"></h3>
                </header>
                <div id="sub_index_content">
                </div>
            </div>
            <footer id="main_index_footer"></footer>
        </div>
    </body>
    <script>
        class json_reader {
            static ParseMainIndexJson(json){
                document.title = json.title;
                document.getElementById("main_index_title").innerHTML = json.title;
                document.getElementById("main_index_description").innerHTML = json.description;
                document.getElementById("main_index_footer").innerHTML = json.footer;

                let nav_buttons = [];
                for(let n in json.navigation){
                    let nav = json.navigation[n];
                    nav_buttons.push(`<button onclick="json_reader.FetchJson("./data/${nav.slug}/index.json", json_reader.ParseSubIndexJson)">${nav.title}</button>`);
                }
                document.getElementById("main_index_title").innerHTML = nav_buttons.join(" | ");

            }

            static ParseSubIndexJson(json){
                document.getElementById("sub_index_title").innerHTML = json.title;
                document.getElementById("sub_index_description").innerHTML = json.description;
                document.getElementById("sub_index_category").innerHTML = json.category;

                let content_divs = "";
                for(let c in json.content){
                    let content = json.content[c];
                    content_divs.push(`<div><header><h1>${content.title}</h1><h3>${content.text}</h3></header><div id="${content.type}"></div></div>`);
                    json_reader.FetchJson(`./data/${json.category}/${content.url}`,json_reader[`Parse_${content.type}Json`]);
                }
                document.getElementById("sub_index_content").innerHTML = content_divs;
            }

            static Parse_lecturesJson(json){

            }

            static Parse_keywordsJson(json){
                
            }

            static Parse_questionsJson(json){
                let html = `<div><header><h1>${json.title}</h1><h3>${json.category}</h3></header><div id="${content.type}">`;

                for(let q in json.questions){
                    let question = json.questions[q];
                    html += `<p>${question.question}</br><select>`;
                    for(let a in question.answers){
                        let answer = question.answers[a];
                        html += `<option value="${answer.correct}">${answer.answer}</option>`;
                    }
                    html += "</select></p>";
                }
                html += "</div></div>";

                document.getElementById("questions").innerHTML = html;
            }

            static FetchJson(url, parser){
                fetch(url)
                    .then((response)=>{
                        return response.json();
                    })
                    .then((json)=>{
                        parser(json);
                    });
            }
        }
        
        json_reader.FetchJson("data/index.json", json_reader.ParseMainIndexJson);
    </script>
</html>